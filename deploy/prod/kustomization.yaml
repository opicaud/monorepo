resources:
  - ../base
namePrefix: prod-
patches:
  - target:
      group: argoproj.io
      version: v1alpha1
      kind: ApplicationSet
      name: apps
    patch: |-
      - op: replace
        path: /spec/template/spec/project
        value: prod-apps
      - op: replace
        path: /spec/template/metadata/name
        value: prod-{{path.basename}}
      - op: add
        path: /spec/template/spec/source
        value:
          repoURL: https://github.com/opicaud/monorepo.git
          targetRevision: HEAD
          path: '{{path}}'
          helm:
            valueFiles:
              - values-prod.yaml
      - op: replace
        path: /spec/template/spec/destination/namespace
        value: prod